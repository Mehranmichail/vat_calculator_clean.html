<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UK Statutory Residence Test Calculator</title>
    <style>
        * { box-sizing: border-box; }
        
        .srt-calc-wrapper {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            font-family: Georgia, serif;
        }

        .srt-calc-header {
            background: linear-gradient(135deg, #2d5016 0%, #3d6b1f 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .srt-calc-header h1 {
            font-size: 2em;
            margin: 0 0 10px 0;
        }

        .srt-info-box {
            background: #f0f9ff;
            padding: 20px;
            margin: 20px;
            border-radius: 10px;
            border-left: 4px solid #3d6b1f;
        }

        .srt-content {
            padding: 40px;
        }

        .srt-progress {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 20px 0;
        }

        .srt-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3d6b1f 0%, #4caf50 100%);
            transition: width 0.5s ease;
            width: 16.67%;
        }

        .srt-step {
            display: none;
        }

        .srt-step.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .srt-question {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 5px solid #3d6b1f;
        }

        .srt-question h3 {
            color: #2d5016;
            margin: 0 0 15px 0;
            font-size: 1.3em;
        }

        .srt-help {
            background: #e8f5e9;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #1b5e20;
        }

        .srt-input {
            margin: 20px 0;
        }

        .srt-input label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .srt-input input,
        .srt-input select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: Georgia, serif;
        }

        .srt-input input:focus,
        .srt-input select:focus {
            outline: none;
            border-color: #3d6b1f;
        }

        .srt-option {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .srt-option:hover {
            border-color: #3d6b1f;
            background: #f0f9ff;
        }

        .srt-option.selected {
            border-color: #3d6b1f;
            background: #e8f5e9;
        }

        .srt-option input {
            margin-right: 10px;
        }

        .srt-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .srt-btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-family: Georgia, serif;
            cursor: pointer;
            transition: all 0.3s;
        }

        .srt-btn-primary {
            background: #3d6b1f;
            color: white;
        }

        .srt-btn-primary:hover {
            background: #2d5016;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(61, 107, 31, 0.3);
        }

        .srt-btn-secondary {
            background: #6c757d;
            color: white;
        }

        .srt-btn-secondary:hover {
            background: #5a6268;
        }

        .srt-results {
            display: none;
            padding: 30px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e8f5e9 100%);
            border-radius: 12px;
            margin-top: 30px;
        }

        .srt-results.show {
            display: block;
        }

        .srt-result-box {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .srt-result-box h2 {
            color: #2d5016;
            margin: 0 0 20px 0;
        }

        .srt-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin: 10px 0;
        }

        .srt-badge-resident { background: #4caf50; color: white; }
        .srt-badge-nonresident { background: #ff9800; color: white; }
        .srt-badge-split { background: #2196f3; color: white; }

        .srt-explanation {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #3d6b1f;
        }

        .srt-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .srt-warning h4 { color: #856404; margin: 0 0 10px 0; }

        .srt-tips {
            background: #d1ecf1;
            border: 2px solid #17a2b8;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .srt-tips h4 { color: #0c5460; margin: 0 0 10px 0; }

        @media (max-width: 768px) {
            .srt-calc-header h1 { font-size: 1.5em; }
            .srt-content { padding: 20px; }
            .srt-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="srt-calc-wrapper">
    <div class="srt-calc-header">
        <h1>üè† UK Statutory Residence Test Calculator</h1>
        <p>Determine your UK tax residence status for 2025/26</p>
    </div>

    <div class="srt-info-box">
        <strong>Tax Year 2025/26:</strong> This calculator determines your UK residence status based on the Statutory Residence Test (SRT) rules.
    </div>

    <div class="srt-content">
        <div class="srt-progress">
            <div class="srt-progress-bar" id="progressBar"></div>
        </div>

        <!-- Step 1 -->
        <div class="srt-step active" id="step1">
            <div class="srt-question">
                <h3>Tax Year Under Review</h3>
                <div class="srt-input">
                    <label>Which tax year are you checking?</label>
                    <select id="taxYear">
                        <option value="2025-26">2025/26 (6 April 2025 - 5 April 2026)</option>
                        <option value="2024-25">2024/25 (6 April 2024 - 5 April 2025)</option>
                        <option value="2023-24">2023/24 (6 April 2023 - 5 April 2024)</option>
                    </select>
                </div>
                <div class="srt-help">üí° Select the tax year you want to determine your residence status for.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-primary" onclick="goTo(2)">Next</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div class="srt-step" id="step2">
            <div class="srt-question">
                <h3>Days Present in the UK</h3>
                <div class="srt-input">
                    <label>From Date (Start of period in UK):</label>
                    <input type="date" id="dateFrom" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; font-family: Georgia, serif; margin-bottom: 15px;">
                </div>
                <div class="srt-input">
                    <label>To Date (End of period in UK):</label>
                    <input type="date" id="dateTo" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 1em; font-family: Georgia, serif; margin-bottom: 15px;">
                </div>
                <div class="srt-input">
                    <label>OR enter days manually:</label>
                    <input type="number" id="daysInUK" min="0" max="366" placeholder="Enter number of days" readonly style="background: #f0f0f0;">
                    <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        <strong>Calculated days:</strong> <span id="calculatedDays" style="color: #3d6b1f; font-weight: bold;">0 days</span>
                    </p>
                </div>
                <div class="srt-help">üí° Select your arrival and departure dates, and the calculator will automatically count the days. You are present in the UK on a day if you are in the UK at midnight.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="goTo(1)">Previous</button>
                <button class="srt-btn srt-btn-primary" onclick="goTo(3)">Next</button>
            </div>
        </div>

        <!-- Step 3 -->
        <div class="srt-step" id="step3">
            <div class="srt-question">
                <h3>Automatic UK Residence Tests</h3>
                <p>Do any of the following apply to you?</p>
                <div class="srt-option" onclick="toggle('auto1')">
                    <input type="checkbox" id="auto1"> I was present in the UK for 183 days or more
                </div>
                <div class="srt-option" onclick="toggle('auto2')">
                    <input type="checkbox" id="auto2"> I have a home in the UK (and either no overseas home OR was in overseas home &lt;30 days)
                </div>
                <div class="srt-option" onclick="toggle('auto3')">
                    <input type="checkbox" id="auto3"> I work full-time in the UK (35+ hours/week)
                </div>
                <div class="srt-option" onclick="toggle('auto4')">
                    <input type="checkbox" id="auto4"> None of the above apply
                </div>
                <div class="srt-help">üí° If any of the first three apply, you are automatically UK resident.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="goTo(2)">Previous</button>
                <button class="srt-btn srt-btn-primary" onclick="goTo(4)">Next</button>
            </div>
        </div>

        <!-- Step 4 -->
        <div class="srt-step" id="step4">
            <div class="srt-question">
                <h3>Automatic Overseas Tests</h3>
                <p>Do any of the following apply to you?</p>
                <div class="srt-option" onclick="toggle('nonres1')">
                    <input type="checkbox" id="nonres1"> I was present in UK for &lt;16 days (or &lt;46 if not resident in previous 3 years)
                </div>
                <div class="srt-option" onclick="toggle('nonres2')">
                    <input type="checkbox" id="nonres2"> I work full-time overseas and was in UK &lt;91 days (worked in UK &lt;31 days)
                </div>
                <div class="srt-option" onclick="toggle('nonres3')">
                    <input type="checkbox" id="nonres3"> None of the above apply
                </div>
                <div class="srt-help">üí° If any of the first two apply, you are automatically non-UK resident.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="goTo(3)">Previous</button>
                <button class="srt-btn srt-btn-primary" onclick="goTo(5)">Next</button>
            </div>
        </div>

        <!-- Step 5 -->
        <div class="srt-step" id="step5">
            <div class="srt-question">
                <h3>UK Ties - Sufficient Ties Test</h3>
                <div class="srt-input">
                    <label>Were you UK resident in any of the previous 3 tax years?</label>
                    <div class="srt-option" onclick="selectRadio('prevRes', 'yes')">
                        <input type="radio" name="prevRes" id="prevResYes" value="yes"> Yes (Leavers - stricter thresholds)
                    </div>
                    <div class="srt-option" onclick="selectRadio('prevRes', 'no')">
                        <input type="radio" name="prevRes" id="prevResNo" value="no"> No (Arrivers - more generous)
                    </div>
                </div>
                <h4 style="margin-top: 25px; color: #2d5016;">UK Ties (Select all that apply):</h4>
                <div class="srt-option" onclick="toggle('tie1')">
                    <input type="checkbox" id="tie1"> <strong>Family:</strong> Spouse/partner or minor children are UK resident
                </div>
                <div class="srt-option" onclick="toggle('tie2')">
                    <input type="checkbox" id="tie2"> <strong>Accommodation:</strong> Have UK accommodation available 91+ days
                </div>
                <div class="srt-option" onclick="toggle('tie3')">
                    <input type="checkbox" id="tie3"> <strong>Work:</strong> Worked in UK for 40+ days (3+ hours/day)
                </div>
                <div class="srt-option" onclick="toggle('tie4')">
                    <input type="checkbox" id="tie4"> <strong>90-Day:</strong> Spent 90+ days in UK in either of previous 2 years
                </div>
                <div class="srt-option" onclick="toggle('tie5')">
                    <input type="checkbox" id="tie5"> <strong>Country (Leavers only):</strong> Spent more days in UK than any other country
                </div>
                <div class="srt-help">üí° More ties = fewer days needed to be resident.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="goTo(4)">Previous</button>
                <button class="srt-btn srt-btn-primary" onclick="goTo(6)">Next</button>
            </div>
        </div>

        <!-- Step 6 -->
        <div class="srt-step" id="step6">
            <div class="srt-question">
                <h3>Split Year Treatment</h3>
                <p style="margin-bottom: 15px;">Split year treatment may apply if you moved to/from the UK during the tax year. Do any of these apply?</p>
                
                <h4 style="color: #2d5016;">Arriving in the UK Cases:</h4>
                <div class="srt-option" onclick="toggle('split1')">
                    <input type="checkbox" id="split1"> <strong>Case 4:</strong> I started to have my only home in the UK (and was non-resident the previous year)
                </div>
                <div class="srt-option" onclick="toggle('split2')">
                    <input type="checkbox" id="split2"> <strong>Case 5:</strong> I started full-time work in the UK (and will be resident in following year)
                </div>
                <div class="srt-option" onclick="toggle('split3')">
                    <input type="checkbox" id="split3"> <strong>Case 6:</strong> My partner stopped full-time work overseas and I came to the UK with them
                </div>
                <div class="srt-option" onclick="toggle('split4')">
                    <input type="checkbox" id="split4"> <strong>Case 7:</strong> I stopped full-time work overseas and came to the UK
                </div>
                <div class="srt-option" onclick="toggle('split8')">
                    <input type="checkbox" id="split8"> <strong>Case 8:</strong> I started to have a home in the UK only (and will be resident in following year)
                </div>
                
                <h4 style="color: #2d5016; margin-top: 25px;">Leaving the UK Cases:</h4>
                <div class="srt-option" onclick="toggle('split5')">
                    <input type="checkbox" id="split5"> <strong>Case 1:</strong> I started full-time work overseas (and was UK resident in previous year, and non-resident in following year due to full-time work overseas)
                </div>
                <div class="srt-option" onclick="toggle('split6')">
                    <input type="checkbox" id="split6"> <strong>Case 2:</strong> My partner started full-time work overseas and I left the UK to accompany them
                </div>
                <div class="srt-option" onclick="toggle('split7')">
                    <input type="checkbox" id="split7"> <strong>Case 3:</strong> I ceased to have a home in the UK (moved abroad to live permanently)
                </div>
                <div class="srt-option" onclick="toggle('split9')">
                    <input type="checkbox" id="split9"> None of these apply
                </div>
                <div class="srt-help">üí° Split year treatment divides the tax year into UK and overseas parts, potentially reducing UK tax liability. HMRC defines 8 cases: Cases 1-3 are for leaving the UK, Cases 4-8 are for arriving in the UK. Strict conditions must be met for each case - consult HMRC guidance RDR3 or a tax adviser to confirm eligibility.</div>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="goTo(5)">Previous</button>
                <button class="srt-btn srt-btn-primary" onclick="calculate()">Calculate Result</button>
            </div>
        </div>

        <!-- Results -->
        <div class="srt-results" id="results">
            <div class="srt-result-box">
                <h2>Your UK Residence Status</h2>
                <div id="output"></div>
            </div>
            <div class="srt-warning">
                <h4>‚ö†Ô∏è Important Notice</h4>
                <p>This calculator provides guidance only. For definitive advice, consult a qualified tax adviser or refer to HMRC guidance RDR3.</p>
            </div>
            <div class="srt-tips">
                <h4>üí° Next Steps</h4>
                <ul>
                    <li>Keep detailed records of UK arrival/departure dates</li>
                    <li>Maintain evidence of ties</li>
                    <li>Consider split year treatment if applicable</li>
                    <li>Consult a tax adviser for complex situations</li>
                </ul>
            </div>
            <div class="srt-buttons">
                <button class="srt-btn srt-btn-secondary" onclick="reset()">Start New Calculation</button>
                <button class="srt-btn srt-btn-primary" onclick="window.print()">Print Results</button>
            </div>
        </div>
    </div>
</div>

<script>
let current = 1;

// Calculate days between dates
function calculateDays() {
    const dateFrom = document.getElementById('dateFrom').value;
    const dateTo = document.getElementById('dateTo').value;
    
    if (dateFrom && dateTo) {
        const from = new Date(dateFrom);
        const to = new Date(dateTo);
        
        if (to >= from) {
            // Calculate days inclusive (both start and end dates count)
            const diffTime = Math.abs(to - from);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
            
            document.getElementById('daysInUK').value = diffDays;
            document.getElementById('calculatedDays').textContent = diffDays + ' days';
            document.getElementById('calculatedDays').style.color = '#3d6b1f';
        } else {
            document.getElementById('calculatedDays').textContent = 'End date must be after start date';
            document.getElementById('calculatedDays').style.color = '#dc3545';
            document.getElementById('daysInUK').value = '';
        }
    }
}

// Add event listeners for date changes
document.addEventListener('DOMContentLoaded', function() {
    const dateFrom = document.getElementById('dateFrom');
    const dateTo = document.getElementById('dateTo');
    
    if (dateFrom) {
        dateFrom.addEventListener('change', calculateDays);
    }
    if (dateTo) {
        dateTo.addEventListener('change', calculateDays);
    }
    
    // Allow manual entry by clicking on the days field
    const daysInput = document.getElementById('daysInUK');
    if (daysInput) {
        daysInput.addEventListener('click', function() {
            this.readOnly = false;
            this.style.background = 'white';
            this.select();
        });
        
        daysInput.addEventListener('blur', function() {
            if (this.value) {
                document.getElementById('calculatedDays').textContent = this.value + ' days (manually entered)';
            }
        });
    }
});

function goTo(step) {
    // Validation
    if (current === 2 && step > 2) {
        const days = document.getElementById('daysInUK').value;
        const dateFrom = document.getElementById('dateFrom').value;
        const dateTo = document.getElementById('dateTo').value;
        
        if (!days || days < 0 || days > 366) {
            if (!dateFrom || !dateTo) {
                alert('Please select dates or enter the number of days (0-366)');
                return;
            }
        }
    }
    if (current === 5 && step > 5) {
        if (!document.querySelector('input[name="prevRes"]:checked')) {
            alert('Please select if you were UK resident in previous 3 years');
            return;
        }
    }
    
    // Hide current, show new
    document.getElementById('step' + current).classList.remove('active');
    document.getElementById('step' + step).classList.add('active');
    current = step;
    
    // Update progress
    document.getElementById('progressBar').style.width = (step / 6 * 100) + '%';
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function toggle(id) {
    const cb = document.getElementById(id);
    cb.checked = !cb.checked;
    cb.closest('.srt-option').classList.toggle('selected', cb.checked);
    
    // Handle "none" logic
    if ((id === 'auto4' || id === 'nonres3' || id === 'split9') && cb.checked) {
        const group = id.replace(/\d/, '');
        for (let i = 1; i <= 10; i++) {
            const otherId = group + i;
            if (otherId !== id) {
                const other = document.getElementById(otherId);
                if (other) {
                    other.checked = false;
                    other.closest('.srt-option').classList.remove('selected');
                }
            }
        }
    } else if ((id.startsWith('auto') || id.startsWith('nonres') || id.startsWith('split')) && cb.checked) {
        const noneId = id.replace(/\d/, '') + (id.startsWith('split') ? '9' : (id.startsWith('nonres') ? '3' : '4'));
        const none = document.getElementById(noneId);
        if (none) {
            none.checked = false;
            none.closest('.srt-option').classList.remove('selected');
        }
    }
}

function selectRadio(name, val) {
    document.querySelectorAll('[name="' + name + '"]').forEach(r => {
        r.closest('.srt-option').classList.remove('selected');
    });
    const radio = document.getElementById(name + val.charAt(0).toUpperCase() + val.slice(1));
    radio.checked = true;
    radio.closest('.srt-option').classList.add('selected');
}

function calculate() {
    const days = parseInt(document.getElementById('daysInUK').value);
    const year = document.getElementById('taxYear').value;
    const auto1 = document.getElementById('auto1').checked;
    const auto2 = document.getElementById('auto2').checked;
    const auto3 = document.getElementById('auto3').checked;
    const nonres1 = document.getElementById('nonres1').checked;
    const nonres2 = document.getElementById('nonres2').checked;
    const prevRes = document.querySelector('input[name="prevRes"]:checked')?.value === 'yes';
    
    const ties = [
        document.getElementById('tie1').checked,
        document.getElementById('tie2').checked,
        document.getElementById('tie3').checked,
        document.getElementById('tie4').checked,
        document.getElementById('tie5').checked && prevRes
    ].filter(Boolean).length;
    
    const split = ['split1','split2','split3','split4','split5','split6','split7','split8']
        .some(id => document.getElementById(id).checked);
    
    let status = '', badge = '', exp = '';
    
    if (auto1 || auto2 || auto3) {
        status = 'UK Resident';
        badge = 'srt-badge-resident';
        exp = '<h4>Automatic UK Residence Test Met</h4><ul>';
        if (auto1) exp += '<li>‚úì 183+ days (' + days + ' days)</li>';
        if (auto2) exp += '<li>‚úì UK home test met</li>';
        if (auto3) exp += '<li>‚úì Full-time UK work</li>';
        exp += '</ul><p><strong>Result:</strong> Automatically UK resident for ' + year + '</p>';
    } else if (nonres1 || nonres2) {
        status = 'Non-UK Resident';
        badge = 'srt-badge-nonresident';
        exp = '<h4>Automatic Non-Residence Test Met</h4><p><strong>Result:</strong> Automatically non-UK resident for ' + year + '</p>';
    } else {
        let req = 0;
        if (prevRes) {
            if (days >= 16 && days <= 45) req = 4;
            else if (days >= 46 && days <= 90) req = 3;
            else if (days >= 91 && days <= 120) req = 2;
            else if (days >= 121 && days <= 182) req = 1;
        } else {
            if (days >= 46 && days <= 90) req = 4;
            else if (days >= 91 && days <= 120) req = 3;
            else if (days >= 121 && days <= 182) req = 2;
        }
        
        if (days < 16 || (days < 46 && !prevRes)) {
            status = 'Non-UK Resident';
            badge = 'srt-badge-nonresident';
            exp = '<p>Days too low (' + days + ' days)</p>';
        } else if (days >= 183) {
            status = 'UK Resident';
            badge = 'srt-badge-resident';
            exp = '<p>183+ days test met</p>';
        } else if (ties >= req && req > 0) {
            status = 'UK Resident';
            badge = 'srt-badge-resident';
            exp = '<p>' + days + ' days + ' + ties + ' ties = Resident</p>';
        } else {
            status = 'Non-UK Resident';
            badge = 'srt-badge-nonresident';
            exp = '<p>' + days + ' days + ' + ties + ' ties = Non-Resident</p>';
        }
    }
    
    if (split) {
        badge = 'srt-badge-split';
        status += ' (Split Year Possible)';
        
        let splitCases = [];
        if (document.getElementById('split1').checked) splitCases.push('Case 4: Started to have only home in UK');
        if (document.getElementById('split2').checked) splitCases.push('Case 5: Started full-time work in UK');
        if (document.getElementById('split3').checked) splitCases.push('Case 6: Partner stopped overseas work');
        if (document.getElementById('split4').checked) splitCases.push('Case 7: Ceased overseas employment');
        if (document.getElementById('split5').checked) splitCases.push('Case 1: Started full-time work overseas');
        if (document.getElementById('split6').checked) splitCases.push('Case 2: Partner started full-time work overseas');
        if (document.getElementById('split7').checked) splitCases.push('Case 3: Ceased to have UK home');
        if (document.getElementById('split8').checked) splitCases.push('Case 8: Started to have home in UK');
        
        exp += '<div style="background:#fff3cd;padding:15px;margin-top:15px;border-radius:8px">';
        exp += '<h4 style="color:#856404">üîÑ Split Year Treatment May Apply</h4>';
        exp += '<p>Based on your answers, the following split year case(s) may apply:</p><ul style="margin-left:20px">';
        splitCases.forEach(c => exp += '<li>' + c + '</li>');
        exp += '</ul>';
        exp += '<p><strong>Important:</strong> Split year treatment divides the tax year into a UK part and an overseas part. You should only be taxed as a UK resident for the UK part of the year. Strict conditions must be met - consult HMRC guidance RDR3 or a tax adviser to confirm eligibility.</p>';
        exp += '</div>';
    }
    
    document.getElementById('output').innerHTML = 
        '<div class="srt-badge ' + badge + '">' + status + '</div>' +
        '<div class="srt-explanation">' + exp + '</div>' +
        '<table style="width:100%;border-collapse:collapse;margin-top:20px">' +
        '<tr style="background:#f8f9fa"><td style="padding:10px;border:1px solid #ddd"><strong>Tax Year:</strong></td><td style="padding:10px;border:1px solid #ddd">' + year + '</td></tr>' +
        '<tr><td style="padding:10px;border:1px solid #ddd"><strong>Days:</strong></td><td style="padding:10px;border:1px solid #ddd">' + days + '</td></tr>' +
        '<tr style="background:#f8f9fa"><td style="padding:10px;border:1px solid #ddd"><strong>Ties:</strong></td><td style="padding:10px;border:1px solid #ddd">' + ties + '</td></tr>' +
        '<tr><td style="padding:10px;border:1px solid #ddd"><strong>Type:</strong></td><td style="padding:10px;border:1px solid #ddd">' + (prevRes ? 'Leaver' : 'Arriver') + '</td></tr>' +
        '</table>';
    
    document.getElementById('step6').classList.remove('active');
    document.getElementById('results').classList.add('show');
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function reset() {
    document.getElementById('daysInUK').value = '';
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
        cb.closest('.srt-option').classList.remove('selected');
    });
    document.querySelectorAll('input[type="radio"]').forEach(r => {
        r.checked = false;
        r.closest('.srt-option').classList.remove('selected');
    });
    document.getElementById('results').classList.remove('show');
    document.getElementById('step1').classList.add('active');
    current = 1;
    document.getElementById('progressBar').style.width = '16.67%';
    window.scrollTo({top: 0, behavior: 'smooth'});
}
</script>

</body>
</html>
